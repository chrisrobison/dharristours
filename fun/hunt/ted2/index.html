<html>
   <head>
      <title>Boss Invaders</title>
      <script language="JavaScript">
         IE4 = 0;
         fire = 0;
         svrdown = new Image(74,84);
         svrdown.src = "svr-down.gif";
         
         if (document.all) {
            var IE = 1;
         }
         ted = new Array();
         for (i=0;i<8;i++) {
            ted[i] = new Ted(i,0,0,0,0,0);
         }
         function Ted(num,top,left,shot,dead,active) {
            this.num = num;
            this.top = top;
            this.left = left;
            this.shot = shot;
            this.dead = dead;
            this.active = active;
            return true;
         }

         svr = new Array();
         svrs = new Array('KIWI','MOUSE','WOLF','FERRET','MOLE','SLIP3','FOX');
         for (i=0;i<svrs.length;i++) {
            eval("svr[\""+svrs[i]+"\"] = new Server(\""+svrs[i]+"\");");
         }
         function Server(svr) {
            this.dead = 0;
            this.name = svr;
         }
         function moveTed(clnum,wait,posx,posy,x,y) {
            lvl = parseInt(document.forms[0].level.value);
            if ((posx == -1) || (wait == -1) || (posy == -1) || (ted[clnum].dead == 1)) {
               eval("document.TED"+clnum+".visibility = 'hidden';");
               return false;
            }
            if ((posx == -2) || (wait == -2) || (posy == -2)) {
               return false;
            }
            if (posx == 0) {
                  posx = Math.round(Math.random() * window.innerWidth);
                  eval("document.TED"+clnum+".left = "+posx+";");
                  x = ((Math.random()) * (2 * lvl)) + lvl;
                  y = ((Math.random()) * (2 * lvl)) + lvl;
                  z = Math.random();
                  if (z > .5) {
                     x = x * -1;
                  }
            }
            if (wait == 0) {
                  wait = Math.round(Math.random() * (300 / lvl)) + (100 / lvl);
            }
            var tx = posx + x;
            var ty = posy + y;
            posx = tx;
            posy = ty;
            if (ted[clnum].shot == 1) {
               tx = posx - x;
               ty = posy - y;
               posx = tx;
               posy = ty;
            }
            eval("document.TED"+clnum+".visibility = 'show';");
            svrtop = document.KIWI.top;

            if ((ty + 112) > svrtop) {
               checkServer(tx,ty);
            }
            
            if (navigator.appName == "Netscape") {
               if (tx < 0) {
                  tx = window.innerWidth;
                  posx = window.innerWidth;
               }
               if (tx > window.innerWidth) {
                  posx = 1;
                  tx = 1;
               }
               if (ty > window.innerHeight) {
                  posy = 0;
                  posx = 0;
                  tx = 0;
                  ty = 0;
                  wait = 0;
               }
               eval("document.TED"+clnum+".left = "+tx+";");
               eval("document.TED"+clnum+".top = "+ty+";");
               if (ted[clnum].shot == 2) {
                  sx = document.SHOT.left;
                  sy = document.SHOT.top;
                  document.SHOT.left = sx + x;
                  document.SHOT.top = sy + y;
               }
            } else {
               if (posx < 0) {
                  tx = 1000;
                  posx = 1000;
               }
               if (posx > 1000) {
                  posx = 1;
                  tx = 1;
               }
               if (posy > 700) {
                  posy = 0;
                  posx = 0;
                  wait = 0;
                  tx = 0;
                  ty = 0;
               }
               eval("TED"+clnum+".style.top = "+ty+";");
               eval("TED"+clnum+".style.left = "+tx+";");
               if (ted[clnum].shot == 1) {
                  sx = SHOT.style.left;
                  sy = SHOT.style.top;
                  SHOT.style.left = sx + x;
                  SHOT.style.top = sy + y;
               }
            }
            ted[clnum].top = posy;
            ted[clnum].left = posx;
            
            if (ted[clnum].dead != 1) {
               setTimeout("moveTed("+clnum+","+wait+","+posx+","+posy+","+x+","+y+");", wait);
            }
            return true;
         }
         
         function initSlipNet(lvl) {
            newlvltop = (window.innerHeight / 2) - 75;
            document.LEVEL.top = newlvltop;
            svrs = new Array('KIWI','MOUSE','WOLF','FERRET','MOLE','SLIP3','FOX');
            newtop = window.innerHeight - 90;
            spc = Math.round(window.innerWidth / svrs.length);
            cspc = 10;
            for (i=0;i<svrs.length; i++) {
               eval("document."+svrs[i]+".top = "+newtop+";");
               eval("document."+svrs[i]+".left = "+cspc+";");
               cspc = cspc + spc;
            }
            setTimeout("document.LEVEL.visibility='hidden';",2000);
            document.forms[0].state.value = "playing";
            initTed(lvl);
            return true;
         }

         function initTed(lvl) {
            tout = 2000;
            for (i=0;i<8;i++) {
               setTimeout("moveTed("+i+",0,0,0,0,0);", (tout / lvl));
               eval("document.TED"+i+".visibility='hidden';");
               tout += ((Math.random()) * 2000) + 750;
            }
            return true;
         }
      </script>
      <style type="text/css">
         #TED0 {
            position: absolute;
            left: 700; top: 100;
            width: 76;
            zindex: 0;
         }
         #TED1 {
            position: absolute;
            left: 700; top: 100;
            width: 76;
            zindex: 2;
         }
         #TED2 {
            position: absolute;
            left: 700; top: 100;
            width: 76;
            zindex: 3;
         }
         #TED3 {
            position: absolute;
            left: 700; top: 100;
            width: 76;
            zindex: 4;
         }
         #TED4 {
            position: absolute;
            left: 700; top: 100;
            width: 76;
            zindex: 5;
         }
         #TED5 {
            position: absolute;
            left: 700; top: 100;
            width: 76;
            zindex: 6;
         }
         #TED6 {
            position: absolute;
            left: 700; top: 100;
            width: 76;
            zindex: 6;
         }
         #TED7 {
            position: absolute;
            left: 0; top: 100;
            width: 76;
            zindex: 7;
         }
         #CROSSHAIR {
            position: absolute;
            left: 60; top: 36;
         }
         #SHELL {
            position: absolute;
            left: 60; top: 36;
         }
         #SHOT {
            position: absolute;
            left: 60; top: 36;
         }

         #KIWI {
            position: absolute;
            left: 10; top: 500;
         }
         #MOUSE {
            position: absolute;
            left: 150; top: 500;
         }
         #WOLF {
            position: absolute;
            left: 300; top: 500;
         }
         #FERRET {
            position: absolute;
            left: 450; top: 500;
         }
         #MOLE {
            position: absolute;
            left: 600; top: 500;
         }
         #SLIP3 {
            position: absolute;
            left: 750; top: 500;
         }
         #FOX {
            position: absolute;
            left: 900; top: 500;
         }
         #LEVEL {
            font-family:ArialBlack,Arial;
            font-weight:bold;
            font-size:36pt;
            position: absolute;
            left: 400; top: 300;
         }
         
      </style>
   </head>
   <body onLoad="startGame();">
      <form name="display">
         <input type="HIDDEN" name="state" value="idle">
         <table border=1 cellpadding=0 cellspacing=0 bgcolor="#000000">
            <tr>
               <td align=right><font color="#00ff00" face="Arial,Helvetica" size=4><b>Score:&nbsp; </b></font></td>
               <td><font face="Arial,Helvetica" size=3><input type="TEXT" name="score" value="0" size=8></font></td>
               <td><font face="Arial,Helvetica" size=3><b><input type="BUTTON" name="action" value=" Pause " onClick="pauseGame();"></b></font></td>
            </tr>
            <tr>
               <td align=right><font color="#00ff00" face="Arial,Helvetica" size=4><b>Level:&nbsp; </b></font></td>
               <td><font face="Arial,Helvetica" size=3><input type="TEXT" name="level" value="1" size=4></font></td>
               <td><font face="Arial,Helvetica" size=3><b><input type="BUTTON" name="start"  value="  Start  " onClick="startGame();"></b></font></td>
            </tr>
         </table>
      </form>
      <div id="KIWI"><img src="kiwi.jpg" name="KIWI" width=74 height=84></div>
      <div id="MOUSE"><img src="mouse.jpg" name="MOUSE" width=74 height=84></div>
      <div id="WOLF"><img src="wolf.jpg" name="WOLF" width=74 height=84></div>
      <div id="FERRET"><img src="ferret.jpg" name="FERRET" width=74 height=84></div>
      <div id="MOLE"><img src="mole.jpg" name="MOLE" width=74 height=84></div>
      <div id="FOX"><img src="fox.jpg" name="FOX" width=74 height=84></div>
      <div id="SLIP3"><img src="slip3.jpg" name="SLIP3" width=74 height=84></div>

      <div id="TED0" visibility="hidden"><img src="tedhed.gif" border=0 WIDTH=76 HEIGHT=106></div>
      <div id="TED1" visibility="hidden"> <img src="andy-head.gif" border=0 WIDTH=69 HEIGHT=96></div>
      <div id="TED2" visibility="hidden"><img src="tedhed.gif" border=0 WIDTH=76 HEIGHT=106></div>
      <div id="TED3" visibility="hidden"><img src="glen.gif" border=0 WIDTH=103 HEIGHT=148></div>
      <div id="TED4" visibility="hidden"><img src="pifke.gif" border=0 WIDTH=86 HEIGHT=106></div>      
      <div id="TED5" visibility="hidden"><img src="tedhed.gif" border=0 WIDTH=76 HEIGHT=106></div>
      <div id="TED6" visibility="hidden"><img src="andy-head.gif" border=0 WIDTH=69 HEIGHT=96></div>
      <div id="TED7" visibility="hidden"><img src="glen.gif" border=0 WIDTH=103 HEIGHT=148></div>
      <div id="CROSSHAIR"><img src="crosshair.gif"></div>
      <div id="SHOT"><img src="1.gif" name="shot" width=16 height=20></div>
      <div id="SHELL"><img src="1.gif" name="shell" width=32 height=32></div>

      <div id="LEVEL" visibility='hidden'><table width=40% border=0><tr><td align=center><font face="Arial Black,Arial,Helvetica" size=6><b>Level 1</b></font></td></tr></table></div>
   </body>

      <script language="JavaScript">
         var fire = 0;
         var shell = new Image(32, 32);
         shell.src = "shell.gif";

         var shot = new Image(16, 20);
         shot.src = "shot.gif";

         var one = new Image(1, 1);
         one.src = "1.gif";
         
         function moveMouse(e) {
            if (IE4) {
               CROSSHAIR.style.top = e.clientY;
               CROSSHAIR.style.left = e.clientX;
            } else {
               document.CROSSHAIR.left = e.pageX - 16;
               document.CROSSHAIR.top = e.pageY - 16;
            }
            return true;
         }
         function fireGun(e) {
            if ((fire == 1) || (document.forms[0].state.value == "idle")) {
               handleEvent();
               return true;
            }
            if (IE4) {
               SHELL.style.top = e.clientY;
               SHELL.style.left = e.clientX;
            } else {
               document.SHELL.left = e.pageX - 12;
               document.SHELL.top = e.pageY - 12;
            }
            document.SHELL.document.images["shell"].src = shell.src;
            setTimeout("endShot();",700);
            
            return false;
         }
         function endShot() {
            document.SHELL.document.images["shell"].src = one.src;
            fire = 0;
            for (i=0;i<8;i++) {
               tedTop = ted[i].top;
               tedLeft = ted[i].left;
               tedRight = tedLeft + 76;
               tedBottom = tedTop + 112;
               shellY = document.SHELL.top + 8;
               shellX = document.SHELL.left + 8;
               if ((shellY > tedTop) && (shellY < tedBottom)) {
                  if ((shellX > tedLeft) && (shellX < tedRight)) {
                     document.SHOT.top = document.SHELL.top + 8;
                     document.SHOT.left = document.SHELL.left + 8;
                     document.SHOT.document.images["shot"].src = shot.src;
                     ted[i].shot = 1;
                     document.forms[0].score.value = parseInt(document.forms[0].score.value) + (Math.round(document.SHOT.top / 10) * 10);
                     setTimeout("killTarget("+i+");", 1000);
                     break;
                  }
               }
            }
            return false;
         }
         function killTarget(who) {
            moveTed(who, -1, -1, -1, 0, 0);
            if (document.forms[0].start.value == "idle") {
               return true;
            }
            document.SHOT.document.images["shot"].src = one.src;
            ted[who].shot = 1;
            ted[who].dead = 1;
            motogo = 0;
            for (i=0; i<8; i++) {
               if (ted[i].dead == 0) {
                  motogo = 1;
               }
            }

            //
            // All enemy targets cleared so tally this level and move to next
            //
            if (motogo == 0) {
               document.LEVEL.visibility='show';
               document.LEVEL.document.write("<table width=40% border=0><tr><td align=center><font face=\"Arial Black,Arial,Helvetica\" size=6><b>Level "+document.forms[0].level.value+" Cleared</b></font></td></tr></table>");
               document.LEVEL.document.close();
               lvl = parseInt(document.forms[0].level.value);
               lvl += 1;
               eval("setTimeout(\"showLevel("+lvl+");\", 2000);");
               document.forms[0].level.value=lvl;
               for (i=0; i<8; i++) {
                  ted[i].dead = 0;
                  ted[i].shot = 0;
               }
               eval("setTimeout(\"initSlipNet("+lvl+");\", 5000);");
               ted[who].dead = 1;
            }
            return true;
         }

         function checkServer(tx,ty) {
            svrs = new Array('KIWI','MOUSE','WOLF','FERRET','MOLE','SLIP3','FOX');
            for (i=0;i<svrs.length; i++) {
               eval("svrded = svr[\""+svrs[i]+"\"].dead;");
               if (svrded) {
                  continue;
               }
               eval("svrx = document."+svrs[i]+".left;");
               if (((tx + 38) > svrx) && ((tx + 38) < (svrx + 74))) {
                  eval("document."+svrs[i]+".document.images[0].src = 'svr-down.gif';");
                  eval("setTimeout(\"document."+svrs[i]+".document.images[0].src = 'dead.gif';\",1500);");
                  eval("svr[\""+svrs[i]+"\"].dead = 1;");
               }
            }

            svralive = 0;
            for (i=0;i<svrs.length; i++) {
               eval("svrded = svr[\""+svrs[i]+"\"].dead;");
               if (svrded == 0) {
                  svralive = 1;
                  break;
               }
            }
            if (svralive == 0) {
               endGame();
            }
         }

         function endGame() {
            for (i=0; i<8; i++) {
               ted[i].shot = 1;
               ted[i].dead = 1;
            }
            document.LEVEL.document.write("<table width="+(window.innerWidth - 150)+" border=0><tr><td align=center NOWRAP><font face=\"Arial Black,Arial,Helvetica\" size=7><b>G&nbsp;A&nbsp;M&nbsp;E&nbsp;&nbsp;&nbsp;O&nbsp;V&nbsp;E&nbsp;R</b></font></td></tr></table>");
            document.LEVEL.document.close();
            document.LEVEL.visibility='show';
            document.forms[0].state.value = "idle";
            document.forms[0].start.value = "  Start  ";
           return true;
         }
         
         function showLevel(lvl) {
            document.LEVEL.document.write("<table width="+(window.innerWidth - 150)+" border=0><tr><td align=center><font face=\"Arial Black,Arial,Helvetica\" size=7><b>Level "+document.forms[0].level.value+"</b></font></td></tr></table>");
            document.LEVEL.document.close();
            document.LEVEL.visibility='show';
            setTimeout("document.LEVEL.visibility='hidden';",2000);
            return true;
         }            

         function startGame() {
            start = document.forms[0].start.value;
            if (start == " Reset ") {
               document.forms[0].level.value = "1";
               document.forms[0].score.value = "0";
               for (i=0; i<8; i++) {
                  eval("document.TED"+i+".visibility='hidden';");
                  ted[i].dead = 1;
               }
               document.forms[0].start.value = " Start ";
               document.forms[0].state.value = "idle";
            } else {
               document.forms[0].level.value = "1";
               document.forms[0].score.value = "0";
               document.forms[0].start.value = " Reset ";
               document.forms[0].state.value = "playing";
               showLevel();
               initSlipNet(1);
            }
            return true;
         }

         function pauseGame() {
            act = document.forms[0].action.value;
            if (act == " Pause ") {
               for (i=0; i<8; i++) {
                  ted[i].shot = 1;
               }
               document.forms[0].action.value = "Restart";
            } else {
               for (i=0; i<8; i++) {
                  if (ted[i].dead == 0) {
                     ted[i].shot = 0;
                  }
               }
               document.forms[0].action.value = " Pause ";
            }
            return true;
         }
         window.captureEvents(Event.MOUSEMOVE | Event.MOUSEDOWN);
         window.onmousemove = moveMouse;
         window.onmousedown = fireGun;
      </script>
</html>
