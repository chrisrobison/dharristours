<html>
   <head>
      <title>NOVA Calendar Administration</title>
      <link rel="stylesheet" href="default.css" type="text/css">
      <script language="JavaScript">
         var frm = document.forms[0];
         function checkChanges(exec) {
            var frm = document.forms[0];
            if ((frm.modified.value!="") || (frm.exec.value=='new')) {
               OK = confirm("You have made modifications to this record without saving.\nIf you do not save your changes, they will be lost.\n\nClick OK to continue without saving, discarding any modifications.\nClick Cancel to return to form.");
	       if (OK) {
	          if (exec) {
		     frm.exec.value = exec;
		  }   
                  return true;
               } else {
                  return false;
               }          
            } else {
	       if (exec) {
	          frm.exec.value = exec;
	       }   
               return true;
            }   
         }

         function doSave() {
            var frm = document.forms[0];
	    var cur = frm.exec.value;

	    if (cur != 'new') {
	       frm.exec.value = 'update';
	    }
	    setTimeout('document.forms[0].submit();', 150);
	 }

	 function doDelete() {
	    var OK = confirm("Are you sure you want to delete this record?");
	    if (OK) {
	       document.forms[0].exec.value = 'delete';
	       setTimeout("document.forms[0].submit();", 150);
	       return true;
	    } else {
	       return false;
	    }
	 }

         function doNew(defaultFocus) {
            var frm = document.forms[0];
	    frm.exec.value = 'new';

	    var tblfields = new Array(#fields#);
            var defaultFocus = '';

	    for (var i in tblfields) {
	       var n = tblfields[i];
	       if ((document.forms[0][n].type == 'text') || (frm[n].type == 'textarea')) {
	          frm[n].value = '';
		  if (!defaultFocus) {
		     defaultFocus = n;
		  }   
	       }
            }

	    if (defaultFocus) {
	       setTimeout('document.forms[0].'+defaultFocus+'.focus();', 1000);
	    }

	    return true;
	 }

	 function isodate() {
	    var now = new Date();
	    var day = now.getDate();
	    var yr = now.getFullYear();
	    var hr = now.getHours();
	    var min = now.getMinutes();
	    var mon = now.getMonth();
	    mon++;
	    if (day < 10) {
	       day = '0'+day;
	    }
	    if (mon < 10) {
	       mon = '0'+mon;
	    }
	    if (hr < 10) {
	       hr = '0'+hr;
	    }
	    if (min < 10) {
	       min = '0'+min;
	    }
	    var isodate = yr+"-"+mon+"-"+day+" "+hr+":"+min+":00";

	    return isodate;
	 }
        
	 function doChange() {
	    var frm = document.forms[0];
	    var mod = frm.modified.value;
	    
	    if (!mod) {
               frm.modified.value = '1';
	       flashButton('save');
            }
            return true;
	 }

	 function flashButton(who) {
	    var frm = document.forms[0];
	    var curClass = frm[who].className;

	    if (curClass == "CHANGED") {
	       frm[who].className = 'SAVE';
	    } else {
               frm[who].className = 'CHANGED';
	    }
	    setTimeout("flashButton('"+who+"');", 500);

            return true;
	 }
      </script>
   </head>
   <body bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#000099" alink="#ff0000" class="MAIN" onLoad="#alert#">
      <form name="nova" action="index.cgi" onSubmit="return checkChanges();" method="POST">
         <input type="hidden" name="exec" value="">
         <input type="hidden" name="modified" value="">
         <input type="hidden" name="type_display" value="#type_display#">
         <input type="hidden" name="REMOTE_USER" value="#REMOTE_USER#">
	 <br>
         <center>
           <table border="1" cellpadding="4" cellspacing="1" class='TBLMAIN'>
	      <tr>
	         <td colspan='2' class='TBLTITLE'><!--<img src="/img/bulb-logo.gif" align='left'>--><span class='HEADER'>NOVA Calendar Administrator</span></td>
	      </tr>
	      <tr>
	         <td valign='top'>
		    <table border='0' cellpadding='3' cellspacing='1'>
		       <tr>
	                  <td align="right" class="MAIN"><span class='FIELD'>Table:</span></td>
		          <td valign="top" colspan='2'>
		             <select name="table" onChange="checkChanges('change_table') && setTimeout('document.forms[0].submit();', 150);" class='MAIN'>
			        #dbtables#
		             </select>
		          </td>
		       </tr>
		       <tr>
	                  <td valign="top" align="right" class="MAIN"><span class='FIELD'>#Table#:</span></td>
		          <td valign="top">
		             <select name="#curKey#" size="20" onChange="checkChanges('lookup') && setTimeout('document.forms[0].submit();', 150);" class='LIST'>
		                #records#
		             </select>
		          </td>
		       </tr>
		    </table>
		 </td>
		 <td valign='top'>
		       #formUI#
		 </td>
	      </tr>
	      <tr>
	         <td colspan='2' class='MAIN'>
		    <table border='0' cellpadding='3' cellspacing='1' width='100%'>
		       <tr>
		          <td align='left' class='MAIN'>
			     <div id='rmnewbtn' class='#buttons#'>
			     <input type="button" name="btn_new" value="New" onClick="checkChanges() && doNew();" class='BTN' style="border-style:groove;">
			     <input type='button' name="btn_delete" value="Delete" onClick="doDelete();" class='BTN' style="border-style:groove;">
			     </div>
			  </td>
			  <td align='right' class='MAIN'>
		             <div id='save'><input type="button" value="Save" onClick="doSave();" class='SAVE' style="border-style:groove; padding:0pt,8pt,0pt,8pt;" name='save' id='save'></span>&nbsp;&nbsp;&nbsp;
			  </td>
		       </tr>
		    </table>
                 </td>
	      </tr>
           </table>
	 </center>
      </form>
   </body>
</html>

